<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Plotting functions â€¢ q3tools</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">q3tools</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Plotting functions</h1>
                        <h4 class="author">Diego Diez</h4>
            
            <h4 class="date">2017-02-07</h4>
          </div>

    
    
<div class="contents">
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<html><body><a href="#introduction" class="anchor"> </a></body></html>Introduction</h1>
<p>Required packages for building this vignette:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knitr::opts_chunk$<span class="kw">set</span>(<span class="dt">fig.width=</span><span class="dv">5</span>, <span class="dt">fig.height=</span><span class="dv">5</span>)
<span class="kw">library</span>(q3tools)
<span class="kw">library</span>(Biobase)
<span class="kw">library</span>(IRanges)
<span class="kw">library</span>(GenomicRanges)</code></pre></div>
<div id="dots-plot" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#dots-plot" class="anchor"> </a></body></html>Dots plot</h2>
<p>You can use matrices.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tmp1 &lt;-<span class="st"> </span><span class="kw">data.matrix</span>(iris[<span class="dv">1</span>:<span class="dv">4</span>, -<span class="dv">5</span>])
<span class="kw"><a href="../reference/plotPoints.html">plotPoints</a></span>(tmp1, <span class="dt">group =</span> <span class="kw">rep</span>(LETTERS[<span class="dv">1</span>:<span class="dv">2</span>], <span class="dt">each =</span> <span class="dv">2</span>))</code></pre></div>
<p><img src="plots_files/figure-html/unnamed-chunk-1-1.png" width="480"></p>
<p>You can use other objects like <code>ExpressionSet</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(sample.ExpressionSet)
tmp2 &lt;-<span class="st"> </span>sample.ExpressionSet[<span class="dv">1</span>:<span class="dv">4</span>, ]
<span class="kw"><a href="../reference/plotPoints.html">plotPoints</a></span>(tmp2, <span class="dt">group =</span> tmp2$sex)</code></pre></div>
<p><img src="plots_files/figure-html/unnamed-chunk-2-1.png" width="480"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plotPoints.html">plotPoints</a></span>(tmp2, <span class="dt">group =</span> tmp2$type)</code></pre></div>
<p><img src="plots_files/figure-html/unnamed-chunk-2-2.png" width="480"></p>
</div>
<div id="histograms" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#histograms" class="anchor"> </a></body></html>Histograms</h2>
<p>A histogram.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plotHistogram.html">plotHistogram</a></span>(tmp1)</code></pre></div>
<p><img src="plots_files/figure-html/unnamed-chunk-3-1.png" width="480"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plotHistogram.html">plotHistogram</a></span>(tmp1, <span class="dt">group =</span> <span class="kw">rep</span>(LETTERS[<span class="dv">1</span>:<span class="dv">2</span>], <span class="dt">each =</span> <span class="dv">2</span>))</code></pre></div>
<p><img src="plots_files/figure-html/unnamed-chunk-3-2.png" width="480"></p>
<p>An example using <code>ExpressionSet</code> object.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plotHistogram.html">plotHistogram</a></span>(tmp2)</code></pre></div>
<p><img src="plots_files/figure-html/unnamed-chunk-4-1.png" width="480"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plotHistogram.html">plotHistogram</a></span>(tmp2, <span class="dt">group =</span> tmp2$sex)</code></pre></div>
<p><img src="plots_files/figure-html/unnamed-chunk-4-2.png" width="480"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plotHistogram.html">plotHistogram</a></span>(tmp2, <span class="dt">group =</span> tmp2$type)</code></pre></div>
<p><img src="plots_files/figure-html/unnamed-chunk-4-3.png" width="480"></p>
</div>
<div id="pairs" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#pairs" class="anchor"> </a></body></html>Pairs</h2>
<p>A paired scatterplot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plotPairs.html">plotPairs</a></span>(mtcars[,<span class="dv">1</span>:<span class="dv">4</span>])</code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="plots_files/figure-html/unnamed-chunk-5-1.png" width="480"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plotPairs.html">plotPairs</a></span>(mtcars[,<span class="dv">1</span>:<span class="dv">4</span>], <span class="dt">geom.low =</span> <span class="st">"point"</span>, <span class="dt">geom.mid =</span> <span class="st">"density"</span>, <span class="dt">geom.up =</span> <span class="st">"density2d"</span>)</code></pre></div>
<p><img src="plots_files/figure-html/unnamed-chunk-5-2.png" width="480"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tmp &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">1000</span> *<span class="st"> </span><span class="dv">4</span>), <span class="dt">ncol =</span> <span class="dv">4</span>)
<span class="kw"><a href="../reference/plotPairs.html">plotPairs</a></span>(tmp, <span class="dt">geom.low =</span> <span class="st">"hex"</span>, <span class="dt">geom.up =</span> <span class="st">"density2d"</span>)</code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="plots_files/figure-html/unnamed-chunk-5-3.png" width="480"></p>
</div>
<div id="heatmaps" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#heatmaps" class="anchor"> </a></body></html>Heatmaps</h2>
<p>A heatmap.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tmp2 &lt;-<span class="st"> </span>sample.ExpressionSet[<span class="dv">1</span>:<span class="dv">25</span>, ]
<span class="kw"><a href="../reference/plotHeatmap.html">plotHeatmap</a></span>(tmp2)</code></pre></div>
<p><img src="plots_files/figure-html/unnamed-chunk-6-1.png" width="480"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plotHeatmap.html">plotHeatmap</a></span>(tmp2, <span class="dt">col.cluster =</span> <span class="ot">TRUE</span>, <span class="dt">scale =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="plots_files/figure-html/unnamed-chunk-6-2.png" width="480"></p>
<p>A correlation heatmap.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plotCorrelation.html">plotCorrelation</a></span>(<span class="kw">exprs</span>(sample.ExpressionSet), <span class="dt">cluster =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="plots_files/figure-html/unnamed-chunk-7-1.png" width="480"></p>
</div>
<div id="venn-diagrams" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#venn-diagrams" class="anchor"> </a></body></html>Venn diagrams</h2>
<p>A venn diagram.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plotVenn.html">plotVenn</a></span>(
  iris[, -<span class="dv">5</span>] &gt;<span class="st"> </span><span class="dv">2</span>,
  <span class="dt">fill =</span> <span class="kw">c</span>(<span class="st">"cornflowerblue"</span>, <span class="st">"orange"</span>, <span class="st">"darkorchid1"</span>, <span class="st">"yellowgreen"</span>),
  <span class="dt">alpha =</span> .<span class="dv">3</span>,
  <span class="dt">col =</span> <span class="ot">NA</span>
  )</code></pre></div>
<p><img src="plots_files/figure-html/unnamed-chunk-8-1.png" width="480"></p>
</div>
<div id="mds" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#mds" class="anchor"> </a></body></html>MDS</h2>
<p>A MDS plot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plotMds.html">plotMds</a></span>(iris[, -<span class="dv">5</span>], <span class="dt">group =</span> <span class="kw">c</span>(<span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"B"</span>))</code></pre></div>
<p><img src="plots_files/figure-html/unnamed-chunk-9-1.png" width="480"></p>
</div>
<div id="gene-tracks" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#gene-tracks" class="anchor"> </a></body></html>Gene tracks</h2>
<p>A gene track.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot some gene.</span>
<span class="kw"><a href="../reference/plotGene.html">plotGene</a></span>(<span class="st">"Stat1"</span>, <span class="st">"mm10"</span>)
<span class="co"># add some data.</span>
f &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"files/example.bam"</span>, <span class="dt">package =</span> <span class="st">"q3tools"</span>)
<span class="kw"><a href="../reference/plotGene.html">plotGene</a></span>(<span class="st">"Stat1"</span>, <span class="st">"mm10"</span>, <span class="dt">add.data =</span> <span class="kw">list</span>(<span class="st">"Exo+"</span> =<span class="st"> </span>f))
<span class="co"># zoom in.</span>
<span class="kw"><a href="../reference/plotGene.html">plotGene</a></span>(<span class="st">"Stat1"</span>, <span class="st">"mm10"</span>, <span class="dt">add.data =</span> <span class="kw">list</span>(<span class="st">"Exo+"</span> =<span class="st"> </span>f), <span class="dt">from =</span> <span class="fl">52.12e6</span>, <span class="dt">to =</span> <span class="fl">52.14e6</span>)</code></pre></div>
<p>The above code may fail if the genome version at Biomart differs from the version expected by Gviz, the underlaying package used by plotGene. In that case, the biomart object mast be specified directly. In that case, the argument <code>genome</code> is ignored.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(biomaRt)
mart &lt;-<span class="st"> </span><span class="kw">useMart</span>(<span class="dt">biomart =</span> <span class="st">"ensembl"</span>, <span class="dt">dataset =</span> <span class="st">"mmusculus_gene_ensembl"</span>)
f &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"files/example.bam"</span>, <span class="dt">package =</span> <span class="st">"q3tools"</span>)
<span class="kw"><a href="../reference/plotGene.html">plotGene</a></span>(<span class="st">"Stat1"</span>, <span class="dt">biomart =</span> mart, <span class="dt">add.data =</span> <span class="kw">list</span>(<span class="st">"Exo+"</span> =<span class="st"> </span>f), <span class="dt">from =</span> <span class="fl">52.12e6</span>, <span class="dt">to =</span> <span class="fl">52.14e6</span>)</code></pre></div>
<p><img src="plots_files/figure-html/unnamed-chunk-11-1.png" width="480"></p>
</div>
<div id="ranges" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#ranges" class="anchor"> </a></body></html>Ranges</h2>
<p>A set of ranges.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tmp &lt;-<span class="st"> </span><span class="kw">IRanges</span>(<span class="dt">start =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">7</span>, <span class="dv">10</span>, <span class="dv">5</span>, <span class="dv">13</span>), <span class="dt">end =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">12</span>, <span class="dv">15</span>, <span class="dv">8</span>, <span class="dv">14</span>))
tmp</code></pre></div>
<pre><code>## IRanges object with 5 ranges and 0 metadata columns:
##           start       end     width
##       &lt;integer&gt; &lt;integer&gt; &lt;integer&gt;
##   [1]         1         4         4
##   [2]         7        12         6
##   [3]        10        15         6
##   [4]         5         8         4
##   [5]        13        14         2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plotRanges.html">plotRanges</a></span>(tmp, <span class="dt">sep =</span> .<span class="dv">3</span>)</code></pre></div>
<p><img src="plots_files/figure-html/unnamed-chunk-12-1.png" width="480"></p>
<p>If we have GRanges we have to specified the seqname.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># create GRanges from IRanges.</span>
tmp &lt;-<span class="st"> </span><span class="kw">GRanges</span>(<span class="dt">seqnames =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>), <span class="dt">ranges =</span> tmp)
<span class="kw"><a href="../reference/plotRanges.html">plotRanges</a></span>(tmp, <span class="dt">seqnames =</span> <span class="st">"1"</span>)</code></pre></div>
<p><img src="plots_files/figure-html/unnamed-chunk-13-1.png" width="480"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plotRanges.html">plotRanges</a></span>(tmp, <span class="dt">seqnames =</span> <span class="st">"2"</span>)</code></pre></div>
<p><img src="plots_files/figure-html/unnamed-chunk-13-2.png" width="480"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># override seqnames.</span>
<span class="kw"><a href="../reference/plotRanges.html">plotRanges</a></span>(<span class="kw">ranges</span>(tmp))</code></pre></div>
<p><img src="plots_files/figure-html/unnamed-chunk-13-3.png" width="480"></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#introduction">Introduction</a><ul class="nav nav-pills nav-stacked">
<li><a href="#dots-plot">Dots plot</a></li>
      <li><a href="#histograms">Histograms</a></li>
      <li><a href="#pairs">Pairs</a></li>
      <li><a href="#heatmaps">Heatmaps</a></li>
      <li><a href="#venn-diagrams">Venn diagrams</a></li>
      <li><a href="#mds">MDS</a></li>
      <li><a href="#gene-tracks">Gene tracks</a></li>
      <li><a href="#ranges">Ranges</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Diego Diez.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
